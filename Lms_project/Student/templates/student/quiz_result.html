{% extends 'base.html' %}
{% load static %}

{% block title %}Quiz Result{% endblock %}

{% block content %}
{% include "student/_sidebar.html" %}

<div class="main-content" style="margin-left:200px; padding:35px; min-height:100vh;">

  <!-- Go Back button (TOP-LEFT) -->
  <div class="mb-3">
    <a href="javascript:history.back()" class="btn btn-outline-danger">
      <i class="fas fa-arrow-left"></i> Go Back
    </a>
  </div>

  <!-- Quiz Result Card -->
  <div class="card shadow-lg p-4 rounded-4">
    <h2 class="text-center mb-4 text-primary">{{ quiz.title }} - Result</h2>

    <!-- Score Section -->
    <div class="text-center mb-4">
      <h4>Your Score:</h4>
      <h2 class="fw-bold text-success">{{ score }}/{{ quiz.total_marks }}</h2>
      <p class="text-muted">
        Correct Questions: <strong>{{ correct_answers }}</strong> /
        Total: <strong>{{ total_questions }}</strong>
      </p>
    </div>

    <!-- Question Review -->
    {% if question_results %}
    <h4 class="mt-4">Question Review</h4>
    <div class="mt-3">
      {% for item in question_results %}
      <div class="mb-3 p-3 rounded border
                  {% if item.is_correct %}
                  border-success bg-light
                  {% else %}
                  border-danger bg-light
                  {% endif %}">
        <p><strong>Q{{ forloop.counter }}:</strong> {{ item.question.text }}</p>

        <p>
          <strong>Your answer:</strong>
          <span class="{% if item.is_correct %}text-success{% else %}text-danger{% endif %}">
            {{ item.selected_option }}
          </span>
        </p>

        <p><strong>Correct answer:</strong>
          <span class="text-success">{{ item.correct_option }}</span>
        </p>
      </div>
      {% endfor %}
    </div>
    {% endif %}

    <!-- Buttons -->
    <div class="text-center mt-4">
      <a href="{% url 'student:student_dashboard' %}" class="btn btn-secondary me-2">
        Back to Dashboard
      </a>
    </div>
  </div>

</div>

{% endblock %}
